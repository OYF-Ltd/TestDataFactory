<div class="ch bg dx dy dz ea"><div class=""><h1 id="b4c1" class="pw-post-title et eu ev be ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk fl fm fn fo fp fq fr fs ft fu fv bj" data-selectable-paragraph="">The ultimate Apex Test Data Factory üè≠üëå</h1></button></div></div></div></div></div></div></div></div></div><h1 id="982c" class="km kn ev be ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bj" data-selectable-paragraph="">Overview of Apex Testing</h1><figure class="ln lo lp lq lr ls lk ll paragraph-image"><div class="lk ll lm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lh6DOSkDgNR6drXLEd0sPw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lh6DOSkDgNR6drXLEd0sPw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lh6DOSkDgNR6drXLEd0sPw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lh6DOSkDgNR6drXLEd0sPw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lh6DOSkDgNR6drXLEd0sPw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lh6DOSkDgNR6drXLEd0sPw.png 1100w, https://miro.medium.com/v2/resize:fit:472/format:webp/1*lh6DOSkDgNR6drXLEd0sPw.png 472w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 236px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lh6DOSkDgNR6drXLEd0sPw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lh6DOSkDgNR6drXLEd0sPw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lh6DOSkDgNR6drXLEd0sPw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lh6DOSkDgNR6drXLEd0sPw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lh6DOSkDgNR6drXLEd0sPw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lh6DOSkDgNR6drXLEd0sPw.png 1100w, https://miro.medium.com/v2/resize:fit:472/1*lh6DOSkDgNR6drXLEd0sPw.png 472w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 236px"><img alt="" class="bg lt lu c" width="236" height="205" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:472/1*lh6DOSkDgNR6drXLEd0sPw.png"></picture></div></figure><p id="8417" class="pw-post-body-paragraph lv lw ev lx b ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms eo bj" data-selectable-paragraph="">In order to deploy Apex code to production</p><ul class=""><li id="0892" class="lv lw ev lx b ly lz ma mb mc md me mf mt mh mi mj mu ml mm mn mv mp mq mr ms mw mx my bj" data-selectable-paragraph=""><em class="mz">[Required] </em>At least 75% of your Apex code must be covered by unit tests, and all of those tests must pass</li><li id="d8e1" class="lv lw ev lx b ly na ma mb mc nb me mf mt nc mi mj mu nd mm mn mv ne mq mr ms mw mx my bj" data-selectable-paragraph=""><em class="mz">[Required]</em> Every trigger must have some test coverage.</li><li id="987b" class="lv lw ev lx b ly na ma mb mc nb me mf mt nc mi mj mu nd mm mn mv ne mq mr ms mw mx my bj" data-selectable-paragraph=""><em class="mz">[Recommended]</em> Use a test data factory utility</li><li id="5e01" class="lv lw ev lx b ly na ma mb mc nb me mf mt nc mi mj mu nd mm mn mv ne mq mr ms mw mx my bj" data-selectable-paragraph=""><em class="mz">[Recommended] A</em>void using SeeAllData=true</li><li id="c54f" class="lv lw ev lx b ly na ma mb mc nb me mf mt nc mi mj mu nd mm mn mv ne mq mr ms mw mx my bj" data-selectable-paragraph=""><em class="mz">[Recommended]</em> Use the @TestSetup annotation</li></ul><p id="a376" class="pw-post-body-paragraph lv lw ev lx b ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms eo bj" data-selectable-paragraph="">In order to write tests, you need to generate test data</p><h1 id="d16b" class="km kn ev be ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bj" data-selectable-paragraph="">TestDataFactory to the rescue !</h1><figure class="ln lo lp lq lr ls lk ll paragraph-image"><div role="button" tabindex="0" class="ng nh go ni bg nj"><div class="lk ll nf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fV06eqirHjmpiZn1ZUPgZg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fV06eqirHjmpiZn1ZUPgZg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fV06eqirHjmpiZn1ZUPgZg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fV06eqirHjmpiZn1ZUPgZg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fV06eqirHjmpiZn1ZUPgZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fV06eqirHjmpiZn1ZUPgZg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fV06eqirHjmpiZn1ZUPgZg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*fV06eqirHjmpiZn1ZUPgZg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fV06eqirHjmpiZn1ZUPgZg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fV06eqirHjmpiZn1ZUPgZg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fV06eqirHjmpiZn1ZUPgZg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fV06eqirHjmpiZn1ZUPgZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fV06eqirHjmpiZn1ZUPgZg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fV06eqirHjmpiZn1ZUPgZg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg lt lu c" width="700" height="272" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:1400/1*fV06eqirHjmpiZn1ZUPgZg.png"></picture></div></div></figure><blockquote class="nk nl nm"><p id="cd48" class="lv lw mz lx b ly lz ma mb mc md me mf mt mh mi mj mu ml mm mn mv mp mq mr ms eo bj" data-selectable-paragraph="">The ultimate Apex Test Data Factory</p></blockquote><p id="ccd4" class="pw-post-body-paragraph lv lw ev lx b ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms eo bj" data-selectable-paragraph=""><a class="af nn" href="https://github.com/OYF-Ltd/TestDataFactory" rel="noopener ugc nofollow" target="_blank">TestDataFactory</a> is an Apex Test Data Factory that uses the <a class="af nn" href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_dynamic_describe_objects_understanding.htm" rel="noopener ugc nofollow" target="_blank">Apex Describe Information</a> to automatically detect and auto-fill all the required fields of an sObject</p><p id="a264" class="pw-post-body-paragraph lv lw ev lx b ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms eo bj" data-selectable-paragraph="">Features of the Test Data Factory <a class="af nn" href="https://github.com/OYF-Ltd/TestDataFactory" rel="noopener ugc nofollow" target="_blank"><strong class="lx ew">TestDataFactory</strong></a></p><ol class=""><li id="8dd4" class="lv lw ev lx b ly lz ma mb mc md me mf mt mh mi mj mu ml mm mn mv mp mq mr ms no mx my bj" data-selectable-paragraph=""><strong class="lx ew">Auto</strong>-detect all the required fields of an sObject and <strong class="lx ew">auto</strong>-assign them <strong class="lx ew">auto</strong>-generated default values</li><li id="5dad" class="lv lw ev lx b ly na ma mb mc nb me mf mt nc mi mj mu nd mm mn mv ne mq mr ms no mx my bj" data-selectable-paragraph=""><strong class="lx ew">Auto</strong>-detect all the required lookup fields of an sObject and <strong class="lx ew">auto</strong>-create the related sObjects and applies the feature 1</li></ol><h1 id="1f6b" class="km kn ev be ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bj" data-selectable-paragraph="">Examples</h1><h2 id="0d25" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph=""><strong class="al">1- Create an sObject</strong></h2><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="acf oj l"><iframe src="https://benahm0.medium.com/media/abf4d8fc05bd63b3640d6ecb850a1bfc" allowfullscreen="" frameborder="0" height="61" width="680" title="TestDataFactory - Create an sObject" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="20f5" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph=""><strong class="al">2- Create a Contact by providing a map to assign values to fields in the main and the related sObjects</strong></h2><p id="6d2b" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">You can assign values to the main sObject or any related sObject, all sObjects will be created with the required fields auto-filled</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="acg oj l"><iframe src="https://benahm0.medium.com/media/6a0b12ac8943b1aad8dab72b3c25fcb3" allowfullscreen="" frameborder="0" height="171" width="680" title="TestDataFactory.example2.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="93d9" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph="">3- Auto-generate values for non required fields</h2><p id="a70d" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">You can auto-generate a value for a non required field by assigning the TestDataFactory.DEFAULT_VALUE to it, in the Map of values</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="ach oj l"><iframe src="https://benahm0.medium.com/media/b32ed754a4d19227ef96465b799cb819" allowfullscreen="" frameborder="0" height="127" width="680" title="TestDataFactory.example3.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="2c77" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph="">4- Force the instantiation of a related sObject</h2><p id="400b" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">For example when creating a Contact you can force the Test Data Factory to create a related Account, even if an Account is not required</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="aci oj l"><iframe src="https://benahm0.medium.com/media/73c6dd2c0dfd7303b8cc005c905a0ad5" allowfullscreen="" frameborder="0" height="105" width="680" title="TestDataFactory.example4.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="c1ee" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph="">5- Provide an Id for a required related sObject to avoid its instantiation</h2><p id="4223" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">You can provide an Id for a required related sObject, to force the use of that Id and prevent the instantiation of the related sObject</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="aci oj l"><iframe src="https://benahm0.medium.com/media/841e9a0ec264ad3fc11199eb4bf88e34" allowfullscreen="" frameborder="0" height="105" width="680" title="TestDataFactory.example5.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="969c" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph="">6- Provide a map for a related sObject</h2><p id="5cf1" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">You can provide a sub map of values for a related sObject</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="acj oj l"><iframe src="https://benahm0.medium.com/media/8e9ba8d890b75f939c48356c8e062084" allowfullscreen="" frameborder="0" height="193" width="680" title="TestDataFactory.example6.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="436c" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph="">7- Create and insert a list of Contact sObjects</h2><p id="5dbf" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">Create &amp; insert 10 contacts</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="acf oj l"><iframe src="https://benahm0.medium.com/media/2289fb789ef7c61e6e9969f230a499c7" allowfullscreen="" frameborder="0" height="61" width="680" title="TestDataFactory.example7.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="63b9" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph="">8- Create and insert a list of users using the index merge value</h2><p id="e343" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">The following code creates 10 users with different usernames and nicknames</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="akd oj l"><iframe src="https://benahm0.medium.com/media/b8a83ae7c7edd307441973a88fe84bed" allowfullscreen="" frameborder="0" height="149" width="680" title="TestDataFactory.example8.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="e9b4" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph="">9- Create 5 Accounts with different names</h2><p id="524a" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">Create a list of 5 Account sObjects with different names and a same description</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="ach oj l"><iframe src="https://benahm0.medium.com/media/d8d18c7e86518201076d41a018c92fb1" allowfullscreen="" frameborder="0" height="127" width="680" title="TestDataFactory.example9.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><h2 id="f550" class="np kn ev be ko nq nr ns ks nt nu nv kw mg nw nx ny mk nz oa ob mo oc od oe of bj" data-selectable-paragraph="">10- Create 10 Cases related to 10 Accounts</h2><p id="fef6" class="pw-post-body-paragraph lv lw ev lx b ly ok ma mb mc ol me mf mg om mi mj mk on mm mn mo oo mq mr ms eo bj" data-selectable-paragraph="">Create a list of Acount sObjects and link them to a list of 10 Case sObjects</p><figure class="ln lo lp lq lr ls"><div class="og oh l go"><div class="ake oj l"><iframe src="https://benahm0.medium.com/media/c30b80456af635201f132ac7ea158b92" allowfullscreen="" frameborder="0" height="215" width="680" title="TestDataFactory.example10.cls" class="eh n ei tu bg" scrolling="no"></iframe></div></div></figure><p id="df7d" class="pw-post-body-paragraph lv lw ev lx b ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms eo bj" data-selectable-paragraph="">Read more on github : <a class="af nn" href="https://github.com/OYF-Ltd/TestDataFactory" rel="noopener ugc nofollow" target="_blank">https://github.com/benahm/TestDataFactory</a></p></div>
